<html>
<head >
    <title>Create Appointment</title>
	<link rel="stylesheet" href="styles2.css">
     <link rel="stylesheet" href="bootstrap.min.css">
  <script src="jquery-3.3.1.min.js"></script>
  <script src="bootstrap.min.js"></script>
</head>
<body>
     <header>
<a href="frmHome.html"><img class="imgs" id="picHomeLogo" alt="" src="images/logo%201.png" /></a>
<div class="buttonleft"> 
<a href="frmHome.html">Home</a>
    <a href="frmMyProfile.html">My Profile</a>
<a href="frmAppointment.html">Appointment</a> 
    <a><form method="get"><button name="logout" onclick="log()">Logout</button></form></a>
    <script>
        function log(){
            <?php
    session_start();
            if(isset($_GET['logout']))
            if( isset($_SESSION['User']) ){
          unset($_SESSION['User']);
                
                 header("Location:frmHome.php");
                die;
            }
            ?>
        }
   
       </script>
</div>
    </header>
    <div class="body1">
    <div class="marL">
    <marquee scrollamount="2" direction="up" loop="true"> 
 <span class="font2" >And so<br>
the<br>
adventure<br>
begins<br>
<br><br><br><br><br><br></span>
 <span class="font1" >
love is <br>
the best <br>
     thing that<br>
     can <br>
     happen to<br>
     a person
        </span></marquee>
</div>

        
    <form method="get" novalidate action="frmAppointment.html"><section><center> 
<table>
    <tr>
<td>Appointment No :</td><td><input type="text" name="AppointmentNo" id="AppointmentNo" value="" readonly></td>
</tr>
<tr>
<td colspan="2" ><br></td>
</tr>
    <tr>
    <!--    <?php
            $conn =mysqli_connect("localhost","root","","preethi");
            if(isset($_SESSION['User']))
            {
            $ses=$_SESSION['User']; 
                
            $result =mysqli_query($conn,"SELECT * FROM user_details WHERE UserName='$ses'");
               
            if (mysqli_num_rows($result) > 0) {
    while($row = mysqli_fetch_assoc($result)) {
        ?>-->
<tr>
<td>Username :</td><td><input type="text" name="Username" id="Username" value="" readonly></td>
</tr>
<tr>
<td colspan="2" ><br></td>
</tr>
    <tr>
<td> Email Id: </td>
<td><input type="email" name="email" id="email" value="" required>
</td>
</tr>
    <tr>
<td colspan="2" ><span id="err2" class="errormessage"></span><br></td>
</tr>
<tr>
<td> Phone No: </td>
<td><input type="tel" name="Phone" id="Phone" value="" pattern="[0-9]{10}" required>
</td>
</tr>
<tr>
<td colspan="2" ><span id="err3" class="errormessage"></span><br></td>
</tr>
     <tr>
<td> Wedding Date : </td>
<td><input type="date" name="WeddingDate" id="Wedding Date" min="<?php $today=date('Y-m-d'); echo date('Y-m-d', strtotime($today. ' + 30 day'));?>"required>
</td>
</tr>
    <tr>
<td colspan="2" ><span id="err4" class="errormessage"></span><br></td>
</tr>
<tr>
<td> Appointment Made : </td>
<td><input type="text" name="AppointmentMade" id="Appointment Made" value="" readonly>
</td>
</tr>
    <tr>
<td colspan="2" ><span id="err5" class="errormessage"></span><br></td>
</tr>
    <tr>
    <td> Appointment Date : </td>
<td><input type="date" name="AppointmentDate" id="Appointment Date" min="<?php $today=date('Y-m-d'); echo date('Y-m-d', strtotime($today. ' + 1 day'));?>"required>
</td>
</tr>
    <tr>
<td colspan="2" ><span id="err6" class="errormessage"><?php
                 if( isset($_SESSION['Error']) )
{
        echo $_SESSION['Error'];

        unset($_SESSION['Error']);

    }
                 ?></span><br></td>
</tr>
<tr>
<td colspan="2" > <input class="a_sub" type="submit" value="Submit" name="btnsubmit" id="btnsubmit" ></td>
</tr>

</table>   
</center>                           
</section>
</form>
      <!--  <?php  }
                }                
                
} 
            ?>
        <?php
        if(isset($_GET['btnsubmit']))
    {       
$Username=$_GET['Username'];
$email=$_GET['email'];
$PhoneNo=$_GET['Phone'];
           $wd=$_GET['WeddingDate'];
            $am=$_GET['AppointmentMade'];
            $ad=$_GET['AppointmentDate'];
            $AppointmentNo=$_GET['AppointmentNo'];
         $result1 =mysqli_query($conn,"SELECT AppointmentDate FROM appointment_details WHERE AppointmentDate='$ad'");
		$count1=mysqli_num_rows($result1);
               if($count1>3)
               {
                   $_SESSION['Wedding Date']=$_GET['Wedding Date'];
                   $_SESSION['Error']="Sorry Fully booked for ".$_GET['Appointment Date']; 
               }                 
        
    else        
       {             
            $query="INSERT INTO appointment_details(AppointmentNo, UserName, EmailId, PhoneNo, WeddingDate, AppointmentMade, AppointmentDate) VALUES 
    ('$AppointmentNo','$Username','$email',$PhoneNo,'$wd','$am','$ad')";
        unset($_SESSION['NO']);
mysqli_query($conn, $query);
       header("Location:frmAppointment.php");
  exit;
             }
        }  

        ?>-->
    <script>
    var btns=document.getElementById('btnsubmit');
    btns.onclick=function(e){
        var checkes=val();   
        console.log(checkes);
        if(checkes==false)
            {
                e.preventDefault();           
            } 
       
    };
    
    function val()
    {
        var checkes=1;          
        var email=document.getElementById('email');
        var Phone=document.getElementById('Phone');
        var wd=document.getElementById('Wedding Date');
        var ad=document.getElementById('Appointment Date');
        if(email.checkValidity)
            {
                document.getElementById('err2').innerHTML=email.validationMessage;
                if(email.validationMessage.toString().length!=0)
                checkes=0;
            }
        if(Phone.checkValidity)
            {
                document.getElementById('err3').innerHTML=Phone.validationMessage;
                if(Phone.validationMessage.toString().length!=0)
                checkes=0;
            }      
         if(wd.checkValidity)
            {
                document.getElementById('err4').innerHTML=wd.validationMessage;
                 if(wd.validationMessage.toString().length!=0)
                checkes=0;
            }
        if(ad.checkValidity)
            {
                document.getElementById('err6').innerHTML=ad.validationMessage;
                if(ad.validationMessage.toString().length!=0)
                checkes=0;
            }
        if(checkes==0)
        {
            return false;
        }
           else{
               return true;
           }
    }
        
    
    </script>
    
    <div class="myslideshowR">
   <div id="myCarousel" class="carousel slide" data-ride="carousel">
    <!-- Indicators -->
    <ol class="carousel-indicators">
      <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
      <li data-target="#myCarousel" data-slide-to="1"></li>
      <li data-target="#myCarousel" data-slide-to="2"></li>
    </ol>

    
    <div class="carousel-inner">
      <div class="item active">
        <img class="pics" src="images/w1.jpg" style="width:100%">
      </div>

      <div class="item">
        <img class="pics" src="images/w4.jpg" style="width:100%">
      </div>
    
      <div class="item">
        <img class="pics" src="images/w5.jpg" style="width:100%">
      </div>
    </div>

   
</div>
    </div>
        </div>
</body>
</html>